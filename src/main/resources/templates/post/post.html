<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header"></head>
<body>

<div class="container">
    <div th:replace="fragments/bodyHeader :: bodyHeader"></div>
    <input type="hidden" id="id" th:value="${post.id}">
    <input type="hidden" id="boardId" th:value="${post.board.id}">
    <h1 th:text="${post.title}" class="h1 text-break"></h1>
    <div>
        <span th:text="${post.member.nickname}"></span>
        <span class="text-truncate" th:text="${post.createDate}"></span>
    </div><br>
    <div class="content">
        <p class="p text-break" th:text="${post.content}"></p>
    </div>
    <div>
    <button class="btn" id="updateBtn">수정</button>
    <button class="btn" id="deleteBtn">삭제</button>
    </div>

    <label th:for="content">댓글</label>
    <div id="commentList">
    </div>
    <form role="form" action="/comment" method="post">
        <input type="hidden" name="postId" th:value="${post.id}">
        <div class="form-group">
            <textarea name="content" id="content" class="form-control"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">작성</button>
    </form>

    <div th:replace="fragments/footer :: footer"></div>
</div>
</body>
</html>
<script>
    getCommentList(0)
    function getCommentList(page) {
        $.ajax({
            url: "/comments",
            method: "get",
            data: {postId: $('#id').val(),
                page:page
            },
            success: function (d) {
                $('#commentList').html(d)
            }
        })
    }

    $('#updateBtn').click(function (){
        location.href="/post/form/"+$('#boardId').val()+"/"+$('#id').val()
    })

    $('#deleteBtn').click(function (){
        $.ajax({
            url: "/post",
            method: "delete",
            date: {},
            success: function () {
                alert('s')
            }
        })
    })
</script>